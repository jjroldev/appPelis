import{r as o,a as L,j as t,d as k,e as q,u as C,b as I,c as v,g as w}from"./index-Deu4rx9d.js";import{B as S,A as b,g as A,a as F,C as W,f as M}from"./CardItem-Ljusztfa.js";import{u as K,B as y}from"./BarMenu-DKakb1fF.js";const O=o.memo(({placeholder:f,onSubmit:e})=>{const{searchTerm:d,setSearchTerm:n}=L(),a=o.useRef(null),s=o.useRef(null),[c,l]=o.useState(d);return o.useEffect(()=>{a.current&&a.current.focus()},[]),o.useEffect(()=>(s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{d!==c&&(n(c),e(c))},1e3),()=>{s.current&&clearTimeout(s.current)}),[c]),t.jsx("form",{id:"busqueda",onSubmit:h=>h.preventDefault(),children:t.jsxs("div",{className:"contenedorLupa",children:[t.jsx("input",{ref:a,id:"busqueda-input",type:"text",className:"lupaMovile",placeholder:f,value:c,onChange:h=>l(h.target.value)}),t.jsx("i",{className:"fa-solid fa-magnifying-glass lupaIcono"}),t.jsx("button",{type:"submit",style:{display:"none"}})]})})});function G(){const f=k(),{searchTerm:e,setSearchTerm:d}=L(),{language:n}=q(),{currentPerfil:a,currentUser:s}=C(),{setOpenMenu:c}=I(),l=K();o.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),o.useEffect(()=>{e===""&&l>=900&&f(-1)},[e,l,f]),o.useEffect(()=>{c(!1)},[c]);const h=o.useCallback(u=>{u!==e&&d(u)},[e,d]);v(`favorites-${s==null?void 0:s.id}-${a==null?void 0:a.id}`,()=>w(s==null?void 0:s.id,a==null?void 0:a.id),{enabled:!!(s!=null&&s.id)&&!!(a!=null&&a.id)});const R=o.useMemo(()=>e?`${S}/search/movie?api_key=${b}&language=${n}&query=${e}`:A(n).topRatedMovies,[e,n]),E=o.useMemo(()=>e?`${S}/search/tv?api_key=${b}&language=${n}&query=${e}`:F(n).topRatedSeries,[e,n]),{data:r,isLoading:N}=v([e,"search-movies"],()=>M(R)),{data:i,isLoading:T}=v([e,"search-series"],()=>M(E)),$=N||T,x=o.useMemo(()=>{var p,j;const u=((p=r==null?void 0:r.results)==null?void 0:p.filter(m=>m.backdrop_path&&m.poster_path))||[],g=((j=i==null?void 0:i.results)==null?void 0:j.filter(m=>m.backdrop_path&&m.poster_path))||[];return[...u,...g].sort(()=>Math.random()-.5)},[r==null?void 0:r.results,i==null?void 0:i.results]);if($)return t.jsx("div",{className:"contenedor",children:t.jsx(y,{})});const B=u=>u.map((g,p)=>t.jsx(W,{item:g},p)),_=()=>x.length>0?t.jsx("div",{className:"contenedorItemsBuscar",children:B(x)}):t.jsx("div",{className:"contenedorItemsNoE",children:t.jsxs("p",{children:["La búsqueda de ",e," no arrojó coincidencias."]})});return t.jsxs("div",{className:"contenedor",children:[t.jsx(y,{}),t.jsxs("div",{className:"contenedorBuscar",children:[l<900&&t.jsx(O,{placeholder:"Search movies, series, tv series...",onSubmit:h}),_()]})]})}export{G as default};
