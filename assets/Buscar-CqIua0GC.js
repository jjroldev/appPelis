import{r as o,b as p,j as a,e as S,f as B,u as M,c as L,a as $,g as C,h as F}from"./index-nLxA1X93.js";import{B as A,A as R,g as q}from"./endPoints-D6Ym8Q8U.js";import{C as T}from"./CardMovie-BXMv86Jg.js";import{N as f}from"./NavBar-CxuLc1AR.js";import{u as m}from"./useQuery--5MvWUps.js";import{f as _}from"./fetchData-DCFA1qTy.js";const z=o.memo(({placeholder:n,onSubmit:c})=>{const{searchTerm:d,setSearchTerm:l}=p(),e=o.useRef(null);o.useEffect(()=>{e.current&&e.current.focus()},[d]);const s=i=>{i.preventDefault(),c(d)};return a.jsx("form",{id:"busqueda",className:"flex items-center w-full",onSubmit:s,children:a.jsxs("div",{className:"relative w-full item",children:[a.jsx("input",{ref:e,id:"busqueda-input",type:"text",className:"lupa bg-black border p-2 border-gray-300 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:n,value:d,onChange:i=>l(i.target.value)}),a.jsx("button",{type:"submit",style:{display:"none"}})]})})});function Y(){const{searchTerm:n,setSearchTerm:c}=p(),d=S(),{language:l}=B(),{currentPerfil:e,currentUser:s}=M(),[i,g]=o.useState(window.innerWidth);o.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"})});const{setOpenMenu:v}=L();o.useEffect(()=>{const t=()=>g(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),o.useEffect(()=>{n===""&&i>=900&&d("/home",{state:{fromBuscar:!0}})},[n,i]),o.useEffect(()=>{v(!1)},[]);const x=$(),b=o.useCallback(t=>{c(t)},[c]);m(`favorites-${s==null?void 0:s.id}-${e==null?void 0:e.id}`,()=>C(s==null?void 0:s.id,e==null?void 0:e.id),{enabled:!!(s!=null&&s.id)&&!!(e!=null&&e.id)});const j=async t=>{await F(s==null?void 0:s.id,e==null?void 0:e.id,t),await x.invalidateQueries(`favorites-${s==null?void 0:s.id}-${e==null?void 0:e.id}`)},w=n?`${A}/search/movie?api_key=${R}&language=${l}&query=${n}`:q(l).popularMovies,{data:r,isLoading:y}=m([n||"popularMovies"],()=>_(w)),h=o.useMemo(()=>{var t;return(t=r==null?void 0:r.results)==null?void 0:t.filter(u=>u.backdrop_path&&u.poster_path)},[r==null?void 0:r.results]);if(y)return a.jsx(a.Fragment,{children:a.jsx("div",{className:"contenedor",children:a.jsx(f,{logoBuscar:!0,menu:!0,perfil:!0,condicionExpanded:!0})})});const E=t=>t.map((u,k)=>a.jsx(T,{movie:u,onAddFavorite:()=>j(u)},k)),N=()=>{if(h.length>0)return a.jsx("div",{className:"contenedorPeliculasBuscar",children:E(h)});if(h.length==0)return a.jsx(a.Fragment,{children:a.jsx("div",{className:"contenedorPeliculasNoE",children:a.jsxs("p",{children:["La busqueda de ",n," no arrroj√≥ coincidencias."]})})})};return a.jsxs("div",{className:"contenedor",children:[a.jsx(f,{perfil:!0,menu:!0,logoBuscar:!0,condicionExpanded:!0}),a.jsxs("div",{className:"contenedorBuscar",children:[i<900&&a.jsx(z,{placeholder:"Search Movies",onSubmit:b}),N()]})]})}export{Y as default};
