import{b as B,d as E,e as N,u as $,r as n,a as y,g as F,j as s,S as A,f as b}from"./index-ddgygG09.js";import{B as w,A as C}from"./endPoints-D6Ym8Q8U.js";import{C as L}from"./CardMovie-CDb87WEE.js";import{N as c}from"./NavBar-BIb9Jzd-.js";import{u}from"./useQuery-CXXP28uv.js";import{f as S}from"./fetchData-DCFA1qTy.js";function T(){const{searchTerm:t}=B(),l=E(),{language:f}=N(),{currentPerfil:a,currentUser:e}=$();n.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"})},[]),n.useEffect(()=>{t===""&&l("/home",{state:{fromBuscar:!0}})},[t]);const h=y();u(`favorites-${e==null?void 0:e.id}-${a==null?void 0:a.id}`,()=>F(e==null?void 0:e.id,a==null?void 0:a.id),{enabled:!!(e!=null&&e.id)&&!!(a!=null&&a.id)});const m=async i=>{await b(e==null?void 0:e.id,a==null?void 0:a.id,i),await h.invalidateQueries(`favorites-${e==null?void 0:e.id}-${a==null?void 0:a.id}`)},p=`${w}/search/movie?api_key=${C}&language=${f}&query=${t}`,{data:o,isLoading:g}=u([t,URL],()=>S(p),{refetchOnWindowFocus:!1}),r=n.useMemo(()=>{var i;return(i=o==null?void 0:o.results)==null?void 0:i.filter(d=>d.backdrop_path&&d.poster_path)},[o==null?void 0:o.results]);if(g)return s.jsxs(s.Fragment,{children:[s.jsx(c,{logoBuscar:!0,menu:!0,perfil:!0,condicionExpanded:!0}),s.jsx(A,{})]});const x=i=>i.map((d,j)=>s.jsx(L,{movie:d,onAddFavorite:()=>m(d)},j)),v=()=>{if(r.length>0)return s.jsx("div",{className:"contenedorPeliculasBuscar",children:x(r)});if(t&&o.length==0)return s.jsx(s.Fragment,{children:s.jsx("div",{className:"contenedorPeliculasNoE",children:s.jsxs("p",{children:["La busqueda de ",t," no arrroj√≥ coincidencias."]})})})};return s.jsxs("div",{className:"contenedor",children:[s.jsx(c,{perfil:!0,menu:!0,logoBuscar:!0,condicionExpanded:!0}),s.jsx("div",{className:"contenedorBuscar",children:v()})]})}export{T as default};
