import{b as B,d as N,e as E,u as $,r as n,a as y,g as F,j as e,f as A}from"./index-BXawpmsk.js";import{f as b,B as w,A as C}from"./fetchData-DAcbjTQz.js";import{C as L}from"./CardMovie-Dh6S2SKc.js";import{N as r}from"./NavBar-DPP1jqdt.js";import{u as l}from"./useQuery-dXbOBqBi.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./ModalVideo-l3kQDwrD.js";function T(){const{searchTerm:i}=B(),u=N(),{language:m}=E(),{currentPerfil:a,currentUser:s}=$();n.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"})},[]),n.useEffect(()=>{i===""&&u("/home",{state:{fromBuscar:!0}})},[i]);const h=y();l(`favorites-${s==null?void 0:s.id}-${a==null?void 0:a.id}`,()=>F(s==null?void 0:s.id,a==null?void 0:a.id),{enabled:!!(s!=null&&s.id)&&!!(a!=null&&a.id)});const p=async t=>{await A(s==null?void 0:s.id,a==null?void 0:a.id,t),await h.invalidateQueries(`favorites-${s==null?void 0:s.id}-${a==null?void 0:a.id}`)},f=`${w}/search/movie?api_key=${C}&language=${m}&query=${i}`,{data:o,isLoading:g}=l([i,URL],()=>b(f),{refetchOnWindowFocus:!1}),c=n.useMemo(()=>{var t;return(t=o==null?void 0:o.results)==null?void 0:t.filter(d=>d.backdrop_path&&d.poster_path)},[o==null?void 0:o.results]);if(g)return e.jsxs(e.Fragment,{children:[e.jsx(r,{logoBuscar:!0,menu:!0,perfil:!0,condicionExpanded:!0}),e.jsx("div",{className:"cargando",children:e.jsx("div",{className:"spinner"})})]});const x=t=>t.map((d,j)=>e.jsx(L,{movie:d,onAddFavorite:()=>p(d)},j)),v=()=>{if(c.length>0)return e.jsx("div",{className:"contenedorPeliculasBuscar",children:x(c)});if(i&&o.length==0)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"contenedorPeliculasNoE",children:e.jsxs("p",{children:["La busqueda de ",i," no arrroj√≥ coincidencias."]})})})};return e.jsxs("div",{className:"contenedor",children:[e.jsx(r,{perfil:!0,menu:!0,logoBuscar:!0,condicionExpanded:!0}),e.jsx("div",{className:"contenedorBuscar",children:v()})]})}export{T as default};
