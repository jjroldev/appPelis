import{R,j as e,r as m,m as C,e as N,a as E,b as L}from"./index-B35Nkpx_.js";import{r as T,S as U,C as w,B as D,a as $,b as F,c as k,d as B,g as I}from"./Banner-DIgGD_lr.js";import{U as P,b as W,C as A,c as S,d as O,e as V,f as G,h as Q,i as q}from"./CardItem-Bx-AgVc9.js";import{u as x}from"./NavBar-CwGGg1WS.js";import{u as z}from"./useFavorites-CLtEmoR6.js";import{u as p}from"./useQuery-Bh5W4OKf.js";import{f as j}from"./fetchData-DCFA1qTy.js";function H(a,l){return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`${P}${a.profile_path}`,alt:a.name,className:"main-imageCM"}),e.jsxs("div",{className:"detailsCM flex flex-col",children:[e.jsx("p",{className:"nombre-caster",children:a.name}),e.jsx("p",{className:"papel",children:e.jsx("span",{children:l?a.job:a.character})})]})]})}const g=R.memo(({castMember:a,isCrew:l})=>e.jsx("div",{className:"contenedor-posterCM",children:e.jsx("div",{className:"cardContainerImageCM posterCM",children:H(a,l)})})),y=R.memo(({title:a,isLarge:l=!1,item:s})=>{var d,u;const{handleAddFavorite:o}=z(),c=x(),{data:i,isLoading:t}=p(`collection-${s==null?void 0:s.id}`,()=>{var n;return j(W((n=s==null?void 0:s.belongs_to_collection)==null?void 0:n.id))},{refetchOnWindowFocus:!1,enabled:!!((d=s==null?void 0:s.belongs_to_collection)!=null&&d.id)}),f=m.useMemo(()=>T(c>1e3?l:!1),[c,l]),h=m.useCallback(n=>n==null?void 0:n.map(r=>r.poster_path&&e.jsx(A,{item:r,isLarge:c>1e3?l:!1,onAddFavorite:o},r.id)),[c,l,o]);return t||!((u=i==null?void 0:i.parts)!=null&&u.length)?e.jsx(U,{numItems:6,isLarge:l,title:a}):s!=null&&s.belongs_to_collection?e.jsxs("div",{className:"carousel",children:[e.jsx("h2",{className:"tituloCarousel",children:a}),e.jsx(w,{swipeable:!0,showDots:!1,responsive:f,ssr:!1,infinite:!0,autoPlay:!1,keyBoardControl:!0,partialVisible:!0,className:`${c<600?"carousel-cell":""}`,slidesToSlide:8,children:h(i==null?void 0:i.parts)})]}):null});function J(){var d,u;const{movieId:a}=C(),{language:l}=N(),{data:s}=p(`movieInfo-${a}`,()=>j(S(a).movieDetails),{refetchOnWindowFocus:!1,enabled:!!a}),o=x(),{setSearchTerm:c}=E(),{setOpenMenu:i}=L();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),i(!1),c("")},[a]);const t=n=>n.credits.cast.map(r=>r.profile_path?e.jsx(g,{castMember:r},r.id):null),f=n=>n.credits.crew.map(r=>r.profile_path?e.jsx(g,{castMember:r,isCrew:!0},r.id):null),h=({renderCredits:n,title:r})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:r}),e.jsx(w,{swipeable:!0,draggable:!0,showDots:!1,responsive:k,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${o<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:n})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(D,{itemId:a,logoBuscar:!0,isDetail:!0,type:"movie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx($,{URL:S(s==null?void 0:s.id,l).similar,title:"También te puede interesar",isLarge:!1})]}),s&&((d=s.credits.cast)==null?void 0:d.length)>0&&e.jsx(h,{renderCredits:t(s),title:"CAST"}),s&&((u=s.credits.crew)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"})]}),e.jsx("div",{className:"contenedor-imagenes",children:e.jsx("div",{className:"flex flex-col backdropss",children:e.jsx(F,{item:s})})})]})]})}function K({episode:a,serie_backdrop:l}){var u;const{seriesId:s}=C(),[o,c]=m.useState(null),i=x(),{data:t,isLoading:f}=p(`images-${s}`,()=>j(V(s)),{enabled:!!s&&a.still_path==null,staleTime:1e3*60*30,cacheTime:1e3*60*30});if(m.useEffect(()=>{var n;(n=t==null?void 0:t.backdrops)!=null&&n.length&&o===null&&c(Math.floor(Math.random()*t.backdrops.length))},[t,o]),f)return null;const h=n=>{if(!n)return null;if(n<60)return`${n} min`;const r=Math.floor(n/60),v=n%60;return v>0?`${r} h ${v} min`:`${r} h`},d=a.still_path?a.still_path:(u=t==null?void 0:t.backdrops)!=null&&u.length&&o!==null?t.backdrops[o].file_path:l;return e.jsxs("div",{className:"flex flex-col containerEpisode",children:[e.jsxs("div",{className:"container-episode",children:[e.jsx("div",{className:"wrapper-img-episode",children:d&&e.jsx("img",{src:O+d||l,alt:a.name})}),e.jsxs("div",{className:"info-episode",children:[e.jsxs("h4",{children:[a.episode_number,".  ",a.name]}),e.jsxs("div",{className:"flex flex-row detailsDate",children:[new Date(a.air_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),i>990&&e.jsx("p",{children:h(a.runtime)})]}),i<=990&&e.jsx("p",{children:h(a.runtime)}),i>990&&a.overview&&e.jsx("p",{children:a.overview.length>=300?a.overview.slice(0,301)+"...":a.overview})]}),i>580&&e.jsx("div",{className:"containerPlay",children:e.jsx("i",{className:"fa-solid fa-play"})})]}),i<=990&&a.overview&&e.jsx("div",{className:"overViewEpisodeC",children:e.jsx("p",{className:"overViewEpisode",children:a.overview.length>=300?a.overview.slice(0,301)+"...":a.overview})})]})}function b(){return e.jsx("div",{className:"container-episode",style:{height:"250px"},children:e.jsx(B,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"100%"})})}function _({series:a,numeroTemporadas:l}){const{language:s}=N(),o=x(),[c,i]=m.useState(1),{data:t,isLoading:f}=p(`seasons-${a.id}-${c}`,()=>j(G(a.id,c,s))),[h,d]=m.useState(5),u=m.useRef(null);return m.useEffect(()=>{d(5)},[c]),m.useEffect(()=>{if(!(t!=null&&t.episodes))return;const n=new IntersectionObserver(v=>{v[0].isIntersecting&&d(M=>Math.min(M+8,t.episodes.length))},{threshold:.5}),r=u.current;return r&&n.observe(r),()=>{r&&n.unobserve(r)}},[t==null?void 0:t.episodes]),e.jsxs("div",{className:`containerSeason ${o>=1260&&"CSSinMargin"}`,children:[e.jsxs("div",{className:"contenedorSeleccionSeason",children:[e.jsxs("div",{className:"flex flex-row gap-7.5",children:[e.jsx("h3",{className:"tituloSerie",children:a.name}),I(a)&&e.jsxs("span",{className:"edadParaPublico inline-block max-h-fit",children:[I(a),"+"]})]}),e.jsx("select",{onChange:n=>i(Number(n.target.value)),children:l&&[...Array(l)].map((n,r)=>e.jsxs("option",{value:r+1,children:["Temporada ",r+1]},r))})]}),e.jsxs("div",{className:"contenedorEpisodios",children:[f?e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx(b,{}),e.jsx(b,{})]}):e.jsxs(e.Fragment,{children:[t&&t.episodes.slice(0,h).map((n,r)=>e.jsx(K,{episode:n,serie_backdrop:a.backdrop_path},r)),t&&h<t.episodes.length&&e.jsx("div",{ref:u,style:{height:"20px",background:"transparent"}})]}),!(t!=null&&t.episodes.length)&&e.jsx("div",{className:"w-full text-center",children:e.jsx("p",{className:"overcoming text-center",children:"overcoming ....."})})]})]})}function X(){var d,u;const{seriesId:a}=C(),{language:l}=N(),{data:s}=p(`seriesInfo-${a}`,()=>j(q(a)),{refetchOnWindowFocus:!1,enabled:!!a}),o=x(),{setSearchTerm:c}=E(),{setOpenMenu:i}=L();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),i(!1),c("")},[a]);const t=n=>n.credits.cast.map(r=>r.profile_path?e.jsx(g,{castMember:r},r.id):null),f=n=>n.credits.crew.map(r=>r.profile_path?e.jsx(g,{castMember:r,isCrew:!0},r.id):null),h=({renderCredits:n,title:r})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:r}),e.jsx(w,{swipeable:!0,draggable:!0,showDots:!1,responsive:k,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${o<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:n})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(D,{itemId:a,logoBuscar:!0,isDetail:!0,type:"serie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx($,{URL:Q(s==null?void 0:s.id,l),title:"También te puede interesar",isLarge:!1})]}),s&&((d=s.credits.cast)==null?void 0:d.length)>0&&e.jsx(h,{renderCredits:t(s),title:"CAST"}),s&&((u=s.credits.crew)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"}),s&&o>1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]}),s&&o<=1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]})]})}function te({type:a}){return a=="movie"?e.jsx(J,{}):e.jsx(X,{})}export{te as default};
