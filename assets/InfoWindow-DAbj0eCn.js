import{R as _,j as e,r as m,m as N,e as w,a as L,b as R}from"./index-DkZU9xqd.js";import{r as $,S as T,C as S,B as E,a as D,b as k,c as M,d as U,u as F}from"./useRef-DQP2RuKO.js";import{U as B,b as W,C as A,c as I,d as V,e as O,f as P,h as G,i as Q}from"./CardItem-Bz1U4lJK.js";import{u as v}from"./NavBar-Dq2ZHkbY.js";import{u as q}from"./useFavorites-CTFOSoKv.js";import{u as x}from"./useQuery-QVmoz6KT.js";import{f as j}from"./fetchData-DCFA1qTy.js";function z(a,i){return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`${B}${a.profile_path}`,alt:a.name,className:"main-imageCM"}),e.jsxs("div",{className:"detailsCM flex flex-col",children:[e.jsx("p",{className:"nombre-caster",children:a.name}),e.jsx("p",{className:"papel",children:e.jsx("span",{children:i?a.job:a.character})})]})]})}const g=_.memo(({castMember:a,isCrew:i})=>e.jsx("div",{className:"contenedor-posterCM",children:e.jsx("div",{className:"cardContainerImageCM posterCM",children:z(a,i)})})),y=_.memo(({title:a,isLarge:i=!1,item:s})=>{var l,r;const{handleAddFavorite:p}=q(),c=v(),[n,f]=m.useState(i);m.useEffect(()=>{f(c>1e3?i:!1)},[c]);const{data:t,isLoading:d}=x(`collection-${s==null?void 0:s.id}`,()=>{var h;return j(W((h=s==null?void 0:s.belongs_to_collection)==null?void 0:h.id))},{refetchOnWindowFocus:!1,enabled:!!((l=s==null?void 0:s.belongs_to_collection)!=null&&l.id)}),u=m.useMemo(()=>$(n),[n]),o=m.useCallback(h=>h==null?void 0:h.map(C=>C.poster_path&&e.jsx(A,{item:C,isLarge:n,onAddFavorite:p},C.id)),[n]);return d||!((r=t==null?void 0:t.parts)!=null&&r.length)?e.jsx(T,{numItems:5,isLarge:i,title:a}):s!=null&&s.belongs_to_collection?e.jsxs("div",{className:"carousel",children:[e.jsx("h2",{className:"tituloCarousel",children:a}),e.jsx(S,{swipeable:!0,showDots:!1,responsive:u,ssr:!1,infinite:!0,autoPlay:!1,keyBoardControl:!0,partialVisible:!0,className:`${c<600?"carousel-cell":""}`,slidesToSlide:8,children:o(t==null?void 0:t.parts)})]}):null});function H(){var u,o;const{movieId:a}=N(),{language:i}=w(),{data:s}=x(`movieInfo-${a}`,()=>j(I(a).movieDetails),{refetchOnWindowFocus:!1,enabled:!!a}),p=v(),{setSearchTerm:c}=L(),{setOpenMenu:n}=R();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),n(!1),c("")},[a]);const f=l=>l.credits.cast.map(r=>r.profile_path?e.jsx(g,{castMember:r},r.id):null),t=l=>l.credits.crew.map(r=>r.profile_path?e.jsx(g,{castMember:r,isCrew:!0},r.id):null),d=({renderCredits:l,title:r})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:r}),e.jsx(S,{swipeable:!0,draggable:!0,showDots:!1,responsive:M,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${p<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:l})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(E,{itemId:a,logoBuscar:!0,isDetail:!0,type:"movie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx(D,{URL:I(s==null?void 0:s.id,i).similar,title:"También te puede interesar",isLarge:!1})]}),s&&((u=s.credits.cast)==null?void 0:u.length)>0&&e.jsx(d,{renderCredits:f(s),title:"CAST"}),s&&((o=s.credits.crew)==null?void 0:o.length)>0&&e.jsx(d,{renderCredits:t(s),title:"CREW"})]}),e.jsx("div",{className:"contenedor-imagenes",children:e.jsx("div",{className:"flex flex-col backdropss",children:e.jsx(k,{item:s})})})]})]})}function J({episode:a}){var u;const{seriesId:i}=N(),[s,p]=m.useState(null),c=v(),{data:n,isLoading:f}=x(`images-${i}`,()=>j(O(i)),{enabled:!!i&&a.still_path==null,staleTime:1e3*60*30,cacheTime:1e3*60*30});if(m.useEffect(()=>{var o;(o=n==null?void 0:n.backdrops)!=null&&o.length&&s===null&&p(Math.floor(Math.random()*n.backdrops.length))},[n,s]),f)return null;const t=o=>{if(o<60)return`${o} min`;const l=Math.floor(o/60),r=o%60;return r>0?`${l} h ${r} min`:`${l} h`},d=a.still_path?a.still_path:(u=n==null?void 0:n.backdrops)!=null&&u.length&&s!==null?n.backdrops[s].file_path:"";return e.jsxs("div",{className:"flex flex-col containerEpisode",children:[e.jsxs("div",{className:"container-episode",children:[e.jsx("div",{className:"wrapper-img-episode",children:d&&e.jsx("img",{src:V+d,alt:a.name})}),e.jsxs("div",{className:"info-episode",children:[e.jsxs("h4",{children:[a.episode_number,".  ",a.name]}),e.jsxs("div",{className:"flex flex-row detailsDate",children:[new Date(a.air_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),c>735&&e.jsx("p",{children:t(a.runtime)})]}),c<=735&&e.jsx("p",{children:t(a.runtime)}),c>990&&a.overview&&e.jsx("p",{children:a.overview})]}),c>580&&e.jsx("div",{className:"containerPlay",children:e.jsx("i",{className:"fa-solid fa-play"})})]}),c<990&&a.overview&&e.jsx("div",{className:"overViewEpisodeC",children:e.jsx("p",{className:"overViewEpisode",children:a.overview})})]})}function b(){return e.jsx("div",{className:"container-episode",style:{height:"250px"},children:e.jsx(U,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"100%"})})}function K({seriesId:a,numeroTemporadas:i}){const{language:s}=w(),[p,c]=m.useState(1),[n,f]=m.useState(8),{data:t,isLoading:d}=x(`seasons-${a}-${p}`,()=>j(P(a,p,s))),u=m.useMemo(()=>t?t.episodes.slice(0,n):[],[t,n]),o=m.useCallback(()=>{t&&n<t.episodes.length&&f(r=>Math.min(r+8,t.episodes.length))},[t,n]),l=F(o);return e.jsxs("div",{className:"containerSeason",children:[e.jsx("div",{className:"contenedorSeleccionSeason",children:e.jsx("select",{onChange:r=>{c(Number(r.target.value)),setTimeout(()=>f(8),0)},children:i&&[...Array(i)].map((r,h)=>e.jsxs("option",{value:h+1,children:["Temporada ",h+1]},h))})}),e.jsxs("div",{className:"contenedorEpisodios",children:[d?e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx(b,{}),e.jsx(b,{})]}):u.map((r,h)=>e.jsx(J,{episode:r},h)),e.jsx("div",{ref:l,style:{height:"50px",margin:"20px 0"}})]})]})}function X(){var u,o;const{seriesId:a}=N(),{language:i}=w(),{data:s}=x(`seriesInfo-${a}`,()=>j(Q(a)),{refetchOnWindowFocus:!1,enabled:!!a}),p=v(),{setSearchTerm:c}=L(),{setOpenMenu:n}=R();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),n(!1),c("")},[a]);const f=l=>l.credits.cast.map(r=>r.profile_path?e.jsx(g,{castMember:r},r.id):null),t=l=>l.credits.crew.map(r=>r.profile_path?e.jsx(g,{castMember:r,isCrew:!0},r.id):null),d=({renderCredits:l,title:r})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:r}),e.jsx(S,{swipeable:!0,draggable:!0,showDots:!1,responsive:M,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${p<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:l})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(E,{itemId:a,logoBuscar:!0,isDetail:!0,type:"serie"}),e.jsx("div",{className:"infoItemContainer",children:e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx(D,{URL:G(s==null?void 0:s.id,i),title:"También te puede interesar",isLarge:!1})]}),s&&((u=s.credits.cast)==null?void 0:u.length)>0&&e.jsx(d,{renderCredits:f(s),title:"CAST"}),s&&((o=s.credits.crew)==null?void 0:o.length)>0&&e.jsx(d,{renderCredits:t(s),title:"CREW"}),e.jsx(K,{seriesId:a,numeroTemporadas:s==null?void 0:s.number_of_seasons})]})})]})}function te({type:a}){return a=="movie"?e.jsx(H,{}):e.jsx(X,{})}export{te as default};
