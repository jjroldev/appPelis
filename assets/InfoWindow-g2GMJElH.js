import{R as I,j as e,r as m,m as C,e as w,a as R,b as E}from"./index-CYcxJfxI.js";import{r as y,S as T,C as N,B as L,a as D,b as U,c as $,d as F}from"./Banner-CPPhaibq.js";import{U as B,b as W,C as A,c as S,d as O,e as P,f as V,h as G,i as Q}from"./CardItem-ExMCMV8_.js";import{u as x}from"./NavBar-Cg_pB55y.js";import{u as q}from"./useFavorites-R3t4jx9J.js";import{u as p}from"./useQuery-CHxCXflC.js";import{f as j}from"./fetchData-DCFA1qTy.js";function z(r,i){return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`${B}${r.profile_path}`,alt:r.name,className:"main-imageCM"}),e.jsxs("div",{className:"detailsCM flex flex-col",children:[e.jsx("p",{className:"nombre-caster",children:r.name}),e.jsx("p",{className:"papel",children:e.jsx("span",{children:i?r.job:r.character})})]})]})}const g=I.memo(({castMember:r,isCrew:i})=>e.jsx("div",{className:"contenedor-posterCM",children:e.jsx("div",{className:"cardContainerImageCM posterCM",children:z(r,i)})})),k=I.memo(({title:r,isLarge:i=!1,item:s})=>{var d,u;const{handleAddFavorite:o}=q(),c=x(),{data:l,isLoading:t}=p(`collection-${s==null?void 0:s.id}`,()=>{var n;return j(W((n=s==null?void 0:s.belongs_to_collection)==null?void 0:n.id))},{refetchOnWindowFocus:!1,enabled:!!((d=s==null?void 0:s.belongs_to_collection)!=null&&d.id)}),f=m.useMemo(()=>y(c>1e3?i:!1),[c,i]),h=m.useCallback(n=>n==null?void 0:n.map(a=>a.poster_path&&e.jsx(A,{item:a,isLarge:c>1e3?i:!1,onAddFavorite:o},a.id)),[c,i,o]);return t||!((u=l==null?void 0:l.parts)!=null&&u.length)?e.jsx(T,{numItems:6,isLarge:i,title:r}):s!=null&&s.belongs_to_collection?e.jsxs("div",{className:"carousel",children:[e.jsx("h2",{className:"tituloCarousel",children:r}),e.jsx(N,{swipeable:!0,showDots:!1,responsive:f,ssr:!1,infinite:!0,autoPlay:!1,keyBoardControl:!0,partialVisible:!0,className:`${c<600?"carousel-cell":""}`,slidesToSlide:8,children:h(l==null?void 0:l.parts)})]}):null});function H(){var d,u;const{movieId:r}=C(),{language:i}=w(),{data:s}=p(`movieInfo-${r}`,()=>j(S(r).movieDetails),{refetchOnWindowFocus:!1,enabled:!!r}),o=x(),{setSearchTerm:c}=R(),{setOpenMenu:l}=E();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),l(!1),c("")},[r]);const t=n=>n.credits.cast.map(a=>a.profile_path?e.jsx(g,{castMember:a},a.id):null),f=n=>n.credits.crew.map(a=>a.profile_path?e.jsx(g,{castMember:a,isCrew:!0},a.id):null),h=({renderCredits:n,title:a})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:a}),e.jsx(N,{swipeable:!0,draggable:!0,showDots:!1,responsive:$,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${o<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:n})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(L,{itemId:r,logoBuscar:!0,isDetail:!0,type:"movie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(k,{title:"Collection",item:s}),s&&e.jsx(D,{URL:S(s==null?void 0:s.id,i).similar,title:"También te puede interesar",isLarge:!1})]}),s&&((d=s.credits.cast)==null?void 0:d.length)>0&&e.jsx(h,{renderCredits:t(s),title:"CAST"}),s&&((u=s.credits.crew)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"})]}),e.jsx("div",{className:"contenedor-imagenes",children:e.jsx("div",{className:"flex flex-col backdropss",children:e.jsx(U,{item:s})})})]})]})}function J({episode:r,serie_backdrop:i}){var u;const{seriesId:s}=C(),[o,c]=m.useState(null),l=x(),{data:t,isLoading:f}=p(`images-${s}`,()=>j(P(s)),{enabled:!!s&&r.still_path==null,staleTime:1e3*60*30,cacheTime:1e3*60*30});if(m.useEffect(()=>{var n;(n=t==null?void 0:t.backdrops)!=null&&n.length&&o===null&&c(Math.floor(Math.random()*t.backdrops.length))},[t,o]),f)return null;const h=n=>{if(!n)return null;if(n<60)return`${n} min`;const a=Math.floor(n/60),v=n%60;return v>0?`${a} h ${v} min`:`${a} h`},d=r.still_path?r.still_path:(u=t==null?void 0:t.backdrops)!=null&&u.length&&o!==null?t.backdrops[o].file_path:i;return e.jsxs("div",{className:"flex flex-col containerEpisode",children:[e.jsxs("div",{className:"container-episode",children:[e.jsx("div",{className:"wrapper-img-episode",children:d&&e.jsx("img",{src:O+d||i,alt:r.name})}),e.jsxs("div",{className:"info-episode",children:[e.jsxs("h4",{children:[r.episode_number,".  ",r.name]}),e.jsxs("div",{className:"flex flex-row detailsDate",children:[new Date(r.air_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),l>990&&e.jsx("p",{children:h(r.runtime)})]}),l<=990&&e.jsx("p",{children:h(r.runtime)}),l>990&&r.overview&&e.jsx("p",{children:r.overview.length>=(l>600?300:150)?r.overview.slice(0,(l>600?300:150)+1)+"...":r.overview})]}),l>580&&e.jsx("div",{className:"containerPlay",children:e.jsx("i",{className:"fa-solid fa-play"})})]}),l<=990&&r.overview&&e.jsx("div",{className:"overViewEpisodeC",children:e.jsx("p",{className:"overViewEpisode",children:r.overview.length>=(l>600?300:150)?r.overview.slice(0,(l>600?300:150)+1)+"...":r.overview})})]})}function b(){return e.jsx("div",{className:"container-episode-skeleton",children:e.jsx(F,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"100%"})})}function _({series:r,numeroTemporadas:i}){const{language:s}=w(),o=x(),[c,l]=m.useState(1),{data:t,isLoading:f}=p(`seasons-${r.id}-${c}`,()=>j(V(r.id,c,s))),[h,d]=m.useState(5),u=m.useRef(null);return m.useEffect(()=>{d(5)},[c]),m.useEffect(()=>{if(!(t!=null&&t.episodes))return;const n=new IntersectionObserver(v=>{v[0].isIntersecting&&d(M=>Math.min(M+8,t.episodes.length))},{threshold:.5}),a=u.current;return a&&n.observe(a),()=>{a&&n.unobserve(a)}},[t==null?void 0:t.episodes]),e.jsxs("div",{className:`containerSeason ${o>=1260&&"CSSinMargin"}`,children:[e.jsxs("div",{className:"contenedorSeleccionSeason gap-1",children:[e.jsx("h3",{className:"tituloSerie",children:r.name}),e.jsx("select",{onChange:n=>l(Number(n.target.value)),children:i&&[...Array(i)].map((n,a)=>e.jsxs("option",{value:a+1,children:["Temporada ",a+1]},a))})]}),e.jsxs("div",{className:"contenedorEpisodios",children:[f?e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx(b,{}),e.jsx(b,{})]}):e.jsxs(e.Fragment,{children:[t&&t.episodes.slice(0,h).map((n,a)=>e.jsx(J,{episode:n,serie_backdrop:r.backdrop_path},a)),t&&h<t.episodes.length&&e.jsx("div",{ref:u,style:{height:"20px",background:"transparent"}})]}),!(t!=null&&t.episodes.length)&&e.jsx("div",{className:"w-full text-center",children:e.jsx("p",{className:"overcoming text-center",children:"overcoming ....."})})]})]})}function K(){var d,u;const{seriesId:r}=C(),{language:i}=w(),{data:s}=p(`seriesInfo-${r}`,()=>j(Q(r)),{refetchOnWindowFocus:!1,enabled:!!r}),o=x(),{setSearchTerm:c}=R(),{setOpenMenu:l}=E();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),l(!1),c("")},[r]);const t=n=>n.credits.cast.map(a=>a.profile_path?e.jsx(g,{castMember:a},a.id):null),f=n=>n.credits.crew.map(a=>a.profile_path?e.jsx(g,{castMember:a,isCrew:!0},a.id):null),h=({renderCredits:n,title:a})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:a}),e.jsx(N,{swipeable:!0,draggable:!0,showDots:!1,responsive:$,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${o<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:n})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(L,{itemId:r,logoBuscar:!0,isDetail:!0,type:"serie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(k,{title:"Collection",item:s}),s&&e.jsx(D,{URL:G(s==null?void 0:s.id,i),title:"También te puede interesar",isLarge:!1})]}),s&&((d=s.credits.cast)==null?void 0:d.length)>0&&e.jsx(h,{renderCredits:t(s),title:"CAST"}),s&&((u=s.credits.crew)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"}),s&&o>1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]}),s&&o<=1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]})]})}function ne({type:r}){return r=="movie"?e.jsx(H,{}):e.jsx(K,{})}export{ne as default};
