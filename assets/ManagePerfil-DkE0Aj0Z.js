import{u as C,r as n,e as N,a as v,i as b,j as s,S as k,k as i,l as y,m as S}from"./index-DQEMvmI_.js";import{u as E}from"./useQuery-Ct6Fi3yM.js";function $(){const{currentUser:e,setCurrentPerfil:p}=C(),[x,l]=n.useState(!1),[o,c]=n.useState(""),[f,d]=n.useState(!1),h=N(),m=v(),{data:r=[],isLoading:u}=E(`perfiles-${e==null?void 0:e.id}`,()=>b(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),P=async()=>{if(!o){i.error("Ingresa un nombre");return}if(r.length>=5){i.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}d(!0);try{await y(e==null?void 0:e.id,o)&&(i.success("Perfil creado exitosamente"),c(""),l(!1),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))}catch{i.error("Error al crear el perfil")}finally{d(!1)}},g=async(a,t)=>{t.stopPropagation(),await S(e==null?void 0:e.id,a)?(i.success("Perfil eliminado exitosamente"),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):i.error("Error al eliminar el perfil")},j=a=>{p(a),h("/home")};return u?s.jsx(k,{}):s.jsx("div",{className:"containerPerfiles",children:x?s.jsxs("div",{className:"creacionPerfil",children:[s.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),s.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:a=>c(a.target.value)}),s.jsx("button",{className:"buttonPerfilesCrear",onClick:P,disabled:f,children:f?"Creando...":"Crear"}),s.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!u&&(r.length===0?s.jsxs("div",{className:"flex flex-col contenedorManage",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}):s.jsxs("div",{className:"PerfilesExistentesContainer",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),s.jsx("div",{className:"perfiles",children:r.map(a=>s.jsxs("div",{className:"contenedorPerfil",children:[s.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>j(a)}),s.jsx("h4",{className:"nombrePerfil",children:a.name}),s.jsx("i",{className:"fa-solid fa-x iconoX",onClick:t=>g(a.id,t)})]},a.id))}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]}))})}export{$ as default};
