import{u as j,r as f,e as N,a as g,i as C,j as s,S as v,k as a,l as b,m as k}from"./index-CyazyFac.js";import{u as y}from"./useQuery-Dlwm_kTb.js";function L(){const{currentUser:e,setCurrentPerfil:m}=j(),[u,l]=f.useState(!1),[t,o]=f.useState(""),p=N(),c=g(),{data:r=[],isLoading:d}=y(`perfiles-${e==null?void 0:e.id}`,()=>C(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),x=async()=>{if(!t){a.error("Ingresa un nombre");return}if(r.length>=5){a.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}await b(e==null?void 0:e.id,t)&&(a.success("Perfil creado exitosamente"),o(""),l(!1),c.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))},h=async(i,n)=>{n.stopPropagation(),await k(e==null?void 0:e.id,i)?(a.success("Perfil eliminado exitosamente"),c.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):a.error("Error al eliminar el perfil")},P=i=>{m(i),p("/home")};return d?s.jsx(v,{}):s.jsx("div",{className:"containerPerfiles",children:u?s.jsxs("div",{className:"creacionPerfil",children:[s.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),s.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:i=>o(i.target.value)}),s.jsx("button",{className:"buttonPerfilesCrear",onClick:x,children:"Crear"}),s.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!d&&(r.length===0?s.jsxs("div",{className:"flex flex-col contenedorManage",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}):s.jsxs("div",{className:"PerfilesExistentesContainer",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),s.jsx("div",{className:"perfiles",children:r.map(i=>s.jsxs("div",{className:"contenedorPerfil",children:[s.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>P(i)}),s.jsx("h4",{className:"nombrePerfil",children:i.name}),s.jsx("i",{className:"fa-solid fa-x iconoX",onClick:n=>h(i.id,n)})]},i.id))}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]}))})}export{L as default};
