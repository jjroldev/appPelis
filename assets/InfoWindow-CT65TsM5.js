import{R,j as e,r as m,m as C,e as w,a as E,b as L}from"./index-DFXyw9eQ.js";import{r as M,S as T,C as N,B as D,a as $,b as U,c as k,d as F,g as I}from"./Banner-C2xkBHyE.js";import{U as B,b as P,C as W,c as S,d as A,e as O,f as V,h as G,i as Q}from"./CardItem-DU60fMQA.js";import{u as x}from"./NavBar-CPFOnYXe.js";import{u as q}from"./useFavorites-D0NfVp_M.js";import{u as p}from"./useQuery-DVyyDDg2.js";import{f as j}from"./fetchData-DCFA1qTy.js";function z(a,l){return e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`${B}${a.profile_path}`,alt:a.name,className:"main-imageCM"}),e.jsxs("div",{className:"detailsCM flex flex-col",children:[e.jsx("p",{className:"nombre-caster",children:a.name}),e.jsx("p",{className:"papel",children:e.jsx("span",{children:l?a.job:a.character})})]})]})}const g=R.memo(({castMember:a,isCrew:l})=>e.jsx("div",{className:"contenedor-posterCM",children:e.jsx("div",{className:"cardContainerImageCM posterCM",children:z(a,l)})})),y=R.memo(({title:a,isLarge:l=!1,item:s})=>{var u,i;const{handleAddFavorite:c}=q(),d=x(),{data:o,isLoading:n}=p(`collection-${s==null?void 0:s.id}`,()=>{var r;return j(P((r=s==null?void 0:s.belongs_to_collection)==null?void 0:r.id))},{refetchOnWindowFocus:!1,enabled:!!((u=s==null?void 0:s.belongs_to_collection)!=null&&u.id)}),f=m.useMemo(()=>M(d>1e3?l:!1),[d,l]),h=m.useCallback(r=>r==null?void 0:r.map(t=>t.poster_path&&e.jsx(W,{item:t,isLarge:d>1e3?l:!1,onAddFavorite:c},t.id)),[d,l,c]);return n||!((i=o==null?void 0:o.parts)!=null&&i.length)?e.jsx(T,{numItems:6,isLarge:l,title:a}):s!=null&&s.belongs_to_collection?e.jsxs("div",{className:"carousel",children:[e.jsx("h2",{className:"tituloCarousel",children:a}),e.jsx(N,{swipeable:!0,showDots:!1,responsive:f,ssr:!1,infinite:!0,autoPlay:!1,keyBoardControl:!0,partialVisible:!0,className:`${d<600?"carousel-cell":""}`,slidesToSlide:8,children:h(o==null?void 0:o.parts)})]}):null});function H(){var u,i;const{movieId:a}=C(),{language:l}=w(),{data:s}=p(`movieInfo-${a}`,()=>j(S(a).movieDetails),{refetchOnWindowFocus:!1,enabled:!!a}),c=x(),{setSearchTerm:d}=E(),{setOpenMenu:o}=L();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),o(!1),d("")},[a]);const n=r=>r.credits.cast.map(t=>t.profile_path?e.jsx(g,{castMember:t},t.id):null),f=r=>r.credits.crew.map(t=>t.profile_path?e.jsx(g,{castMember:t,isCrew:!0},t.id):null),h=({renderCredits:r,title:t})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:t}),e.jsx(N,{swipeable:!0,draggable:!0,showDots:!1,responsive:k,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${c<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:r})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(D,{itemId:a,logoBuscar:!0,isDetail:!0,type:"movie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx($,{URL:S(s==null?void 0:s.id,l).similar,title:"También te puede interesar",isLarge:!1})]}),s&&((u=s.credits.cast)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:n(s),title:"CAST"}),s&&((i=s.credits.crew)==null?void 0:i.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"})]}),e.jsx("div",{className:"contenedor-imagenes",children:e.jsx("div",{className:"flex flex-col backdropss",children:e.jsx(U,{item:s})})})]})]})}function J({episode:a,serie_backdrop:l}){var i;const{seriesId:s}=C(),[c,d]=m.useState(null),o=x(),{data:n,isLoading:f}=p(`images-${s}`,()=>j(O(s)),{enabled:!!s&&a.still_path==null,staleTime:1e3*60*30,cacheTime:1e3*60*30});if(m.useEffect(()=>{var r;(r=n==null?void 0:n.backdrops)!=null&&r.length&&c===null&&d(Math.floor(Math.random()*n.backdrops.length))},[n,c]),f)return null;const h=r=>{if(!r)return null;if(r<60)return`${r} min`;const t=Math.floor(r/60),v=r%60;return v>0?`${t} h ${v} min`:`${t} h`},u=a.still_path?a.still_path:(i=n==null?void 0:n.backdrops)!=null&&i.length&&c!==null?n.backdrops[c].file_path:l;return e.jsxs("div",{className:"flex flex-col containerEpisode",children:[e.jsxs("div",{className:"container-episode",children:[e.jsx("div",{className:"wrapper-img-episode",children:u&&e.jsx("img",{src:A+u||l,alt:a.name})}),e.jsxs("div",{className:"info-episode",children:[e.jsxs("h4",{children:[a.episode_number,".  ",a.name]}),e.jsxs("div",{className:"flex flex-row detailsDate",children:[new Date(a.air_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o>990&&e.jsx("p",{children:h(a.runtime)})]}),o<=990&&e.jsx("p",{children:h(a.runtime)}),o>990&&a.overview&&e.jsx("p",{children:a.overview.length>=300?a.overview.slice(0,301)+"...":a.overview})]}),o>580&&e.jsx("div",{className:"containerPlay",children:e.jsx("i",{className:"fa-solid fa-play"})})]}),o<=990&&a.overview&&e.jsx("div",{className:"overViewEpisodeC",children:e.jsx("p",{className:"overViewEpisode",children:a.overview.length>=300?a.overview.slice(0,301)+"...":a.overview})})]})}function b(){return e.jsx("div",{className:"container-episode",style:{height:"250px"},children:e.jsx(F,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"100%"})})}function _({series:a,numeroTemporadas:l}){const{language:s}=w(),c=x(),[d,o]=m.useState(1),{data:n}=p(`seasons-${a.id}-${d}`,()=>j(V(a.id,d,s))),[f,h]=m.useState(5),u=m.useRef(null);return m.useEffect(()=>{h(5)},[d]),m.useEffect(()=>{if(!(n!=null&&n.episodes))return;const i=new IntersectionObserver(t=>{t[0].isIntersecting&&h(v=>Math.min(v+8,n.episodes.length))},{threshold:.5}),r=u.current;return r&&i.observe(r),()=>{r&&i.unobserve(r)}},[n==null?void 0:n.episodes]),e.jsxs("div",{className:`containerSeason ${c>=1260&&"CSSinMargin"}`,children:[e.jsxs("div",{className:"contenedorSeleccionSeason",children:[e.jsxs("div",{className:"flex flex-row gap-7.5",children:[e.jsx("h3",{className:"tituloSerie",children:a.name}),I(a)&&e.jsxs("span",{className:"edadParaPublico inline-block max-h-fit",children:[I(a),"+"]})]}),e.jsx("select",{onChange:i=>o(Number(i.target.value)),children:l&&[...Array(l)].map((i,r)=>e.jsxs("option",{value:r+1,children:["Temporada ",r+1]},r))})]}),e.jsx("div",{className:"contenedorEpisodios",children:n!=null&&n.episodes?e.jsxs(e.Fragment,{children:[n.episodes.slice(0,f).map((i,r)=>e.jsx(J,{episode:i,serie_backdrop:a.backdrop_path},r)),f<n.episodes.length&&e.jsx("div",{ref:u,style:{height:"20px",background:"transparent"}})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx(b,{}),e.jsx(b,{})]})})]})}function K(){var u,i;const{seriesId:a}=C(),{language:l}=w(),{data:s}=p(`seriesInfo-${a}`,()=>j(Q(a)),{refetchOnWindowFocus:!1,enabled:!!a}),c=x(),{setSearchTerm:d}=E(),{setOpenMenu:o}=L();m.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),o(!1),d("")},[a]);const n=r=>r.credits.cast.map(t=>t.profile_path?e.jsx(g,{castMember:t},t.id):null),f=r=>r.credits.crew.map(t=>t.profile_path?e.jsx(g,{castMember:t,isCrew:!0},t.id):null),h=({renderCredits:r,title:t})=>e.jsxs("div",{className:"detallesReparto",children:[e.jsx("h2",{children:t}),e.jsx(N,{swipeable:!0,draggable:!0,showDots:!1,responsive:k,ssr:!0,infinite:!0,keyBoardControl:!1,className:`carousel-cast ${c<630?"cast-visible":""}`,partialVisible:!0,minimumTouchDrag:0,children:r})]});return e.jsxs("div",{className:"contenedorPrincipalItem",children:[e.jsx(D,{itemId:a,logoBuscar:!0,isDetail:!0,type:"serie"}),e.jsxs("div",{className:"infoItemContainer",children:[e.jsxs("div",{className:"detallesInfo",children:[e.jsxs("div",{className:"contenedorSimilares",children:[(s==null?void 0:s.belongs_to_collection)&&e.jsx(y,{title:"Collection",item:s}),s&&e.jsx($,{URL:G(s==null?void 0:s.id,l),title:"También te puede interesar",isLarge:!1})]}),s&&((u=s.credits.cast)==null?void 0:u.length)>0&&e.jsx(h,{renderCredits:n(s),title:"CAST"}),s&&((i=s.credits.crew)==null?void 0:i.length)>0&&e.jsx(h,{renderCredits:f(s),title:"CREW"}),s&&c>1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]}),s&&c<=1260&&e.jsx(_,{series:s,numeroTemporadas:s==null?void 0:s.number_of_seasons})]})]})}function ne({type:a}){return a=="movie"?e.jsx(H,{}):e.jsx(K,{})}export{ne as default};
