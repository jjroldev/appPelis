import{u as P,r as f,c as g,a as N,j as s,k as a}from"./index-BZdF55eJ.js";import{g as C,c as v,d as b}from"./userHelpers-DkS9eNZ9.js";import{u as k}from"./useQuery-B7i_iRC3.js";import"./endPoints-f2vaGF2r.js";function $(){const{currentUser:e,setCurrentPerfil:m}=P(),[p,l]=f.useState(!1),[n,o]=f.useState(""),u=g(),r=N(),{data:t=[],isLoading:c}=k(`perfiles-${e==null?void 0:e.id}`,()=>C(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),x=async()=>{if(!n){a.error("Ingresa un nombre");return}if(t.length>=5){a.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}const i=await v(e==null?void 0:e.id,n);i?(a.success("Perfil creado exitosamente"),r.setQueryData(`perfiles-${e==null?void 0:e.id}`,(d=[])=>[...d,i]),o(""),l(!1),r.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):a.error("Error al crear el perfil")},h=async i=>{await b(e==null?void 0:e.id,i)?(a.success("Perfil eliminado exitosamente"),r.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):a.error("Error al eliminar el perfil")},j=i=>{m(i),u("/home")};return c?s.jsx("div",{className:"h-screen perfilesCargando flex items-center justify-center",children:s.jsx("div",{className:"spinner"})}):s.jsx("div",{className:"containerPerfiles",children:p?s.jsxs("div",{className:"creacionPerfil",children:[s.jsx("img",{src:"appPelis/avatar3.png",alt:""}),s.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:i=>o(i.target.value)}),s.jsx("button",{className:"buttonPerfilesCrear",onClick:x,children:"Crear"}),s.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!c&&(t.length===0?s.jsxs("div",{className:"flex flex-col contenedorManage",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}):s.jsxs("div",{className:"PerfilesExistentesContainer",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),s.jsx("div",{className:"flex flex-row gap-14",children:t.map(i=>s.jsxs("div",{className:"contenedorPerfil",children:[s.jsx("img",{className:"perfil-img",src:"appPelis/avatar3.png",alt:"",onClick:()=>j(i)}),s.jsx("h4",{children:i.name}),s.jsx("i",{className:"fa-solid fa-x iconoX",onClick:()=>h(i.id)})]},i.id))}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]}))})}export{$ as default};
