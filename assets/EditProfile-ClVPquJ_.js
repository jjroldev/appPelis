import{n as E,u as g,r,d as N,f as y,b as h,h as w,j as i,S as C,o as S,p as $,l as x,q as R}from"./index-D-k-lJ28.js";function k(){const{profileId:o}=E(),{currentUser:e}=g(),m=r.useRef(null),d=N(),c=y(),{data:s,isLoading:u}=h(`profile-${o}`,()=>R(e==null?void 0:e.id,o),{staleTime:0}),{isLoading:P}=h(`perfiles-${e==null?void 0:e.id}`,()=>w(e==null?void 0:e.id),{enabled:!!(e!=null&&e.id),staleTime:0}),[t,f]=r.useState("");r.useEffect(()=>{!u&&s&&f(s==null?void 0:s.name)},[u,s]),r.useEffect(()=>{m.current&&m.current.focus()},[]);const v=async a=>{if(a.preventDefault(),!(e!=null&&e.id)||!(s!=null&&s.id)||t.trim()===(s==null?void 0:s.name))return;await S(e.id,s.id,t.trim())&&(c.setQueryData(`profile-${o}`,n=>n&&{...n,name:t.trim()}),c.setQueryData(`perfiles-${e==null?void 0:e.id}`,n=>n?n.map(l=>l.id===s.id?{...l,name:t.trim()}:l):[]),d("/manageProfiles"))},b=async(a,p)=>{p.stopPropagation(),await $(e==null?void 0:e.id,a)?(x.success("Perfil eliminado exitosamente"),c.setQueryData(`perfiles-${e==null?void 0:e.id}`,l=>l?l.filter(j=>j.id!==a):[]),d("/manageProfiles")):x.error("Error al eliminar el perfil")};return u||P?i.jsx(C,{}):i.jsxs("div",{className:"editPerfil",children:[i.jsx("div",{className:"wrapper-title-EP",children:i.jsx("h2",{className:"text-white",children:"Edit profile"})}),i.jsxs("form",{className:"formContainer h-screen",onSubmit:v,children:[i.jsx("div",{className:"wrapper-img-EP",children:i.jsx("img",{src:`/appPelis/${s==null?void 0:s.imagen}`,alt:"Profile"})}),i.jsx("input",{className:"inputTextFormEP",type:"text",placeholder:"Enter name",ref:m,required:!0,value:t,onChange:a=>f(a.target.value)}),i.jsx("div",{className:"wrapper-option-remove",children:i.jsxs("div",{className:"wrapper-description-option-remove flex justify-between items-center",children:[i.jsxs("div",{className:"w-full",children:[i.jsx("h3",{children:"Remove profile?"}),i.jsx("span",{className:"removeSpan",children:"Remove this profile from Justflix."})]}),i.jsx("button",{type:"button",className:"button-EP button-remove",onClick:a=>b(s==null?void 0:s.id,a),children:"Remove"})]})}),i.jsxs("div",{className:"wrapper-buttons-EP w-full h-full flex items-end justify-center gap-6.5",children:[i.jsx("button",{type:"button",className:"button-EP",onClick:()=>d("/manageProfiles"),children:"Cancel"}),i.jsx("button",{type:"submit",className:`button-EP bSaveEP ${t.trim()===(s==null?void 0:s.name)?"disabled-button-EP":""}`,disabled:t.trim()===(s==null?void 0:s.name),children:"Save changes"})]})]})]})}export{k as default};
