import{u as N,r as t,c as b,b as v,d as k,h as y,j as s,S as E,k as i,i as S,l as M}from"./index-D2sbGu3I.js";import{u as Q}from"./useQuery-DaHBGjQS.js";function w(){const{currentUser:e,setCurrentPerfil:p}=N(),[x,l]=t.useState(!1),[o,c]=t.useState(""),[f,d]=t.useState(!1),h=b(),{setOpenMenu:P}=v();t.useEffect(()=>{P(!1)},[]);const m=k(),{data:r=[],isLoading:u}=Q(`perfiles-${e==null?void 0:e.id}`,()=>y(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),g=async()=>{if(!o){i.error("Ingresa un nombre");return}if(r.length>=5){i.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}d(!0);try{await S(e==null?void 0:e.id,o)&&(i.success("Perfil creado exitosamente"),c(""),l(!1),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))}catch{i.error("Error al crear el perfil")}finally{d(!1)}},j=async(a,n)=>{n.stopPropagation(),await M(e==null?void 0:e.id,a)?(i.success("Perfil eliminado exitosamente"),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):i.error("Error al eliminar el perfil")},C=a=>{p(a),h("/home")};return u?s.jsx(E,{}):s.jsx("div",{className:"containerPerfiles",children:x?s.jsxs("div",{className:"creacionPerfil",children:[s.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),s.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:a=>c(a.target.value)}),s.jsx("button",{className:"buttonPerfilesCrear",onClick:g,disabled:f,children:f?"Creando...":"Crear"}),s.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!u&&s.jsxs(s.Fragment,{children:[r.length===0&&s.jsxs("div",{className:"flex flex-col contenedorManage",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}),r.length!=0&&s.jsxs("div",{className:"PerfilesExistentesContainer",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),s.jsx("div",{className:"perfiles",children:r.map(a=>s.jsxs("div",{className:"contenedorPerfil",children:[s.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>C(a)}),s.jsx("h4",{className:"nombrePerfil",children:a.name}),s.jsx("i",{className:"fa-solid fa-x iconoX",onClick:n=>j(a.id,n)})]},a.id))}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]})]})})}export{w as default};
