import{r as o,c as b,j as e,d as B,e as I,u as T,a as q,b as f,g as k}from"./index-BcTlN2JH.js";import{B as x,A as j,g as w,a as A,f as M}from"./fetchData-DSUDSUsj.js";import{C}from"./CardItem-eE-v0onH.js";/* empty css             */import{u as F}from"./useWindowWidth-CaJjiSF3.js";import S from"./BarMenu-Be2yZwds.js";const V=o.memo(({placeholder:d})=>{const{searchTerm:s,setSearchTerm:n}=b(),t=o.useRef(null),[a,l]=o.useState(s);return o.useEffect(()=>{t.current&&t.current.focus()},[]),o.useEffect(()=>{const i=setTimeout(()=>{n(a)},1e3);return()=>clearTimeout(i)},[a,n]),e.jsx("form",{id:"busqueda",onSubmit:i=>i.preventDefault(),children:e.jsxs("div",{className:"contenedorLupa",children:[e.jsx("input",{ref:t,id:"busqueda-input",type:"text",className:"lupaMovile",placeholder:d,value:a,onChange:i=>l(i.target.value)}),e.jsx("i",{className:"fa-solid fa-magnifying-glass lupaIcono"}),e.jsx("button",{type:"submit",style:{display:"none"}})]})})});function G(){const d=B(),{searchTerm:s}=b(),{language:n}=I(),{currentPerfil:t,currentUser:a}=T(),{setOpenMenu:l}=q(),i=F();o.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[]),o.useEffect(()=>{s===""&&i>=900&&d(-1)},[s,i,d]),o.useEffect(()=>{l(!1)},[l]),f(`favorites-${a==null?void 0:a.id}-${t==null?void 0:t.id}`,()=>k(a==null?void 0:a.id,t==null?void 0:t.id),{enabled:!!(a!=null&&a.id)&&!!(t!=null&&t.id)});const y=o.useMemo(()=>s?`${x}/search/movie?api_key=${j}&language=${n}&query=${s}`:w(n).topRatedMovies,[s,n]),E=o.useMemo(()=>s?`${x}/search/tv?api_key=${j}&language=${n}&query=${s}`:A(n).topRatedSeries,[s,n]),{data:r,isLoading:L}=f([s,"search-movies"],()=>M(y)),{data:c,isLoading:N}=f([s,"search-series"],()=>M(E)),$=L||N,g=o.useMemo(()=>{var m,v;const p=((m=r==null?void 0:r.results)==null?void 0:m.filter(u=>u.backdrop_path&&u.poster_path))||[],h=((v=c==null?void 0:c.results)==null?void 0:v.filter(u=>u.backdrop_path&&u.poster_path))||[];return[...p,...h].sort(()=>Math.random()-.5)},[r==null?void 0:r.results,c==null?void 0:c.results]);if($)return e.jsx("div",{className:"contenedor",children:e.jsx(S,{})});const R=p=>p.map((h,m)=>e.jsx(C,{item:h},m)),_=()=>g.length>0?e.jsx("div",{className:"contenedorItemsBuscar",children:R(g)}):e.jsx("div",{className:"contenedorItemsNoE",children:e.jsxs("p",{children:["La búsqueda de ",s," no arrojó coincidencias."]})});return e.jsxs("div",{className:"contenedor",children:[e.jsx(S,{}),e.jsxs("div",{className:"contenedorBuscar",children:[i<900&&e.jsx(V,{placeholder:"Search movies, series, tv series..."}),_()]})]})}export{G as default};
