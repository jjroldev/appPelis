import{u as v,r as l,e as b,a as k,i as y,j as a,S,k as i,l as E,m as I}from"./index-CY5tKcRL.js";import{u as Q}from"./useQuery-D-Cck4BY.js";function $(){const{currentUser:e,setCurrentPerfil:p}=v(),[x,r]=l.useState(!1),[o,c]=l.useState(""),[d,f]=l.useState(!1),g=b(),[h,P]=l.useState(!1);l.useEffect(()=>{const s=new Image;s.src="/appPelis/avatar3.png",s.onload=()=>{P(!0)}},[]);const m=k(),{data:t=[],isLoading:u}=Q(`perfiles-${e==null?void 0:e.id}`,()=>y(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),C=async()=>{if(!o){i.error("Ingresa un nombre");return}if(t.length>=5){i.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}f(!0);try{await E(e==null?void 0:e.id,o)&&(i.success("Perfil creado exitosamente"),c(""),r(!1),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))}catch{i.error("Error al crear el perfil")}finally{f(!1)}},j=async(s,n)=>{n.stopPropagation(),await I(e==null?void 0:e.id,s)?(i.success("Perfil eliminado exitosamente"),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):i.error("Error al eliminar el perfil")},N=s=>{p(s),g("/home")};return u?a.jsx(S,{}):a.jsx("div",{className:"containerPerfiles",children:x?a.jsxs("div",{className:"creacionPerfil",children:[a.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),a.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:s=>c(s.target.value)}),a.jsx("button",{className:"buttonPerfilesCrear",onClick:C,disabled:d,children:d?"Creando...":"Crear"}),a.jsx("button",{className:"buttonListo",onClick:()=>r(!1),children:"Listo"})]}):!u&&a.jsxs(a.Fragment,{children:[t.length===0&&a.jsxs("div",{className:"flex flex-col contenedorManage",children:[a.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),a.jsx("button",{className:"buttonPerfiles",onClick:()=>r(!0),children:"Crea un perfil"})]}),t.length!=0&&h&&a.jsxs("div",{className:"PerfilesExistentesContainer",children:[a.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),a.jsx("div",{className:"perfiles",children:t.map(s=>a.jsxs("div",{className:"contenedorPerfil",children:[a.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>N(s)}),a.jsx("h4",{className:"nombrePerfil",children:s.name}),a.jsx("i",{className:"fa-solid fa-x iconoX",onClick:n=>j(s.id,n)})]},s.id))}),a.jsx("button",{className:"buttonPerfiles",onClick:()=>r(!0),children:"Crear perfil"})]})]})})}export{$ as default};
