import{R,u as y,r as i,a as w,j as e,f as U,e as S,b as F,S as C}from"./index-ddgygG09.js";import{r as E,C as b,B as N}from"./ResponsiveCarrousel-BFP3I-VV.js";import{g as A}from"./endPoints-D6Ym8Q8U.js";import{f as g}from"./fetchData-DCFA1qTy.js";import{u as h}from"./useQuery-CXXP28uv.js";import{C as H}from"./CardMovie-CDb87WEE.js";import"./NavBar-BIb9Jzd-.js";const t=R.memo(({URL:c,title:s,isLarge:o=!1})=>{const{currentPerfil:r,currentUser:l}=y(),{data:u}=h(["movies",c],()=>g(c),{staleTime:1e3*60*5,refetchOnWindowFocus:!1}),[v,d]=i.useState(window.innerWidth),[a,m]=i.useState(o),f=w(),M=i.useMemo(()=>{var n;return((n=u==null?void 0:u.results)==null?void 0:n.filter(L=>L.backdrop_path))||[]},[u]),x=async n=>{await U(l==null?void 0:l.id,r==null?void 0:r.id,n),await f.invalidateQueries(`favorites-${l==null?void 0:l.id}-${r==null?void 0:r.id}`,{refetchInactive:!1})},j=i.useMemo(()=>E(a),[a]),p=i.useCallback(n=>n.map(L=>e.jsx(H,{movie:L,isLarge:a,onAddFavorite:x},L.id)),[a]);return i.useEffect(()=>{const n=()=>d(window.innerWidth);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),i.useEffect(()=>{v<=1e3?m(!1):m(o)},[v]),e.jsx("div",{className:"carousel",children:M.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"tituloCarousel",children:s}),e.jsx(b,{swipeable:!1,draggable:!1,showDots:!1,responsive:j,ssr:!0,infinite:!0,autoPlay:!1,className:"carousel-react",children:p(M)})]})})});function O(){const{language:c}=S(),s=i.useMemo(()=>A(c),[c]),{data:o,isLoading:r}=h(["moviesHome",c],()=>g(s.actionMovies),{staleTime:1e3*60*5}),[l,u]=i.useState(null),{setSearchTerm:v}=F(),d=i.useMemo(()=>{var a;return(a=o==null?void 0:o.results)==null?void 0:a.filter(m=>m.backdrop_path)},[o==null?void 0:o.results]);return i.useEffect(()=>{if(!r&&d.length>0){const a=sessionStorage.getItem("featuredMovie");if(a)u(JSON.parse(a));else{const m=Math.floor(Math.random()*d.length),f=d[m];u(f),sessionStorage.setItem("featuredMovie",JSON.stringify(f))}}},[d]),i.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"}),v("")},[]),r?e.jsx(C,{}):e.jsxs("div",{className:"contenedorHome",children:[e.jsx(N,{movie:l,logoBuscar:!0}),e.jsxs("div",{className:"contenedorPeliculas",children:[e.jsx(t,{URL:s.popularMovies,title:"Popular Movies"}),e.jsx(t,{URL:s.topRatedMovies,title:"Best Voted",isLarge:!0}),e.jsx(t,{URL:s.actionMovies,title:"Action"}),e.jsx(t,{URL:s.adventureMovies,title:"Adventure",isLarge:!0}),e.jsx(t,{URL:s.animationMovies,title:"Animation",isLarge:!0}),e.jsx(t,{URL:s.comedyMovies,title:"Comedy",isLarge:!0}),e.jsx(t,{URL:s.crimeMovies,title:"Crime",isLarge:!0}),e.jsx(t,{URL:s.documentaryMovies,title:"Documentary",isLarge:!0}),e.jsx(t,{URL:s.dramaMovies,title:"Drama",isLarge:!0}),e.jsx(t,{URL:s.familyMovies,title:"Family",isLarge:!0}),e.jsx(t,{URL:s.fantasyMovies,title:"Fantasy",isLarge:!0}),e.jsx(t,{URL:s.historyMovies,title:"History"}),e.jsx(t,{URL:s.horrorMovies,title:"Horror"}),e.jsx(t,{URL:s.musicMovies,title:"Music",isLarge:!0}),e.jsx(t,{URL:s.mysteryMovies,title:"Mystery",isLarge:!0}),e.jsx(t,{URL:s.romanceMovies,title:"Romance",isLarge:!0}),e.jsx(t,{URL:s.scienceFictionMovies,title:"Science Fiction",isLarge:!0}),e.jsx(t,{URL:s.thrillerMovies,title:"Thriller",isLarge:!0})]})]})}export{O as default};
