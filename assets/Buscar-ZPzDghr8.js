import{b as B,d as N,e as E,u as $,r as n,a as y,g as F,j as e,f as A}from"./index-DweVAoJC.js";import{B as b,A as w}from"./endPoints-CFqYS5zJ.js";import{C}from"./CardMovie-LosUg912.js";import{N as r}from"./NavBar-59RzzLAp.js";import{u as l}from"./useQuery-CGNszQ7K.js";import{f as L}from"./fetchData-DCFA1qTy.js";function k(){const{searchTerm:i}=B(),u=N(),{language:m}=E(),{currentPerfil:a,currentUser:s}=$();n.useEffect(()=>{window.scroll({top:0,left:0,behavior:"instant"})},[]),n.useEffect(()=>{i===""&&u("/home",{state:{fromBuscar:!0}})},[i]);const h=y();l(`favorites-${s==null?void 0:s.id}-${a==null?void 0:a.id}`,()=>F(s==null?void 0:s.id,a==null?void 0:a.id),{enabled:!!(s!=null&&s.id)&&!!(a!=null&&a.id)});const f=async t=>{await A(s==null?void 0:s.id,a==null?void 0:a.id,t),await h.invalidateQueries(`favorites-${s==null?void 0:s.id}-${a==null?void 0:a.id}`)},p=`${b}/search/movie?api_key=${w}&language=${m}&query=${i}`,{data:o,isLoading:g}=l([i,URL],()=>L(p),{refetchOnWindowFocus:!1}),c=n.useMemo(()=>{var t;return(t=o==null?void 0:o.results)==null?void 0:t.filter(d=>d.backdrop_path&&d.poster_path)},[o==null?void 0:o.results]);if(g)return e.jsxs(e.Fragment,{children:[e.jsx(r,{logoBuscar:!0,menu:!0,perfil:!0,condicionExpanded:!0}),e.jsx("div",{className:"cargando",children:e.jsx("div",{className:"spinner"})})]});const x=t=>t.map((d,j)=>e.jsx(C,{movie:d,onAddFavorite:()=>f(d)},j)),v=()=>{if(c.length>0)return e.jsx("div",{className:"contenedorPeliculasBuscar",children:x(c)});if(i&&o.length==0)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"contenedorPeliculasNoE",children:e.jsxs("p",{children:["La busqueda de ",i," no arrroj√≥ coincidencias."]})})})};return e.jsxs("div",{className:"contenedor",children:[e.jsx(r,{perfil:!0,menu:!0,logoBuscar:!0,condicionExpanded:!0}),e.jsx("div",{className:"contenedorBuscar",children:v()})]})}export{k as default};
