import{u as P,r as d,d as j,a as N,h as g,j as s,k as a,i as v,l as C}from"./index-DweVAoJC.js";import{u as b}from"./useQuery-CGNszQ7K.js";function Q(){const{currentUser:e,setCurrentPerfil:f}=P(),[m,l]=d.useState(!1),[n,t]=d.useState(""),u=j(),o=N(),{data:r=[],isLoading:c}=b(`perfiles-${e==null?void 0:e.id}`,()=>g(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),x=async()=>{if(!n){a.error("Ingresa un nombre");return}if(r.length>=5){a.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}await v(e==null?void 0:e.id,n)&&(a.success("Perfil creado exitosamente"),t(""),l(!1),o.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))},p=async i=>{await C(e==null?void 0:e.id,i)?(a.success("Perfil eliminado exitosamente"),o.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):a.error("Error al eliminar el perfil")},h=i=>{f(i),u("/home")};return c?s.jsx("div",{className:"h-screen perfilesCargando flex items-center justify-center",children:s.jsx("div",{className:"spinner"})}):s.jsx("div",{className:"containerPerfiles",children:m?s.jsxs("div",{className:"creacionPerfil",children:[s.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),s.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:i=>t(i.target.value)}),s.jsx("button",{className:"buttonPerfilesCrear",onClick:x,children:"Crear"}),s.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!c&&(r.length===0?s.jsxs("div",{className:"flex flex-col contenedorManage",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}):s.jsxs("div",{className:"PerfilesExistentesContainer",children:[s.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),s.jsx("div",{className:"flex flex-row gap-14",children:r.map(i=>s.jsxs("div",{className:"contenedorPerfil",children:[s.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>h(i)}),s.jsx("h4",{children:i.name}),s.jsx("i",{className:"fa-solid fa-x iconoX",onClick:()=>p(i.id)})]},i.id))}),s.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]}))})}export{Q as default};
