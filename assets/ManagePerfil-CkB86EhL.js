import{u as j,r as n,e as N,a as v,i as b,j as a,k as i,l as k,m as y}from"./index-Dbv0Nxsg.js";import{u as E}from"./useQuery-Bh4W8dDL.js";function M(){const{currentUser:e,setCurrentPerfil:u}=j(),[p,l]=n.useState(!1),[o,c]=n.useState(""),[d,f]=n.useState(!1),x=N(),m=v(),{data:r=[],isLoading:h}=E(`perfiles-${e==null?void 0:e.id}`,()=>b(e==null?void 0:e.id),{staleTime:0,enabled:!!(e!=null&&e.id)}),P=async()=>{if(!o){i.error("Ingresa un nombre");return}if(r.length>=5){i.error("Solo puede tener como mÃ¡ximo 5 perfiles");return}f(!0);try{await k(e==null?void 0:e.id,o)&&(i.success("Perfil creado exitosamente"),c(""),l(!1),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`))}catch{i.error("Error al crear el perfil")}finally{f(!1)}},g=async(s,t)=>{t.stopPropagation(),await y(e==null?void 0:e.id,s)?(i.success("Perfil eliminado exitosamente"),m.invalidateQueries(`perfiles-${e==null?void 0:e.id}`)):i.error("Error al eliminar el perfil")},C=s=>{u(s),x("/home")};return a.jsx("div",{className:"containerPerfiles",children:p?a.jsxs("div",{className:"creacionPerfil",children:[a.jsx("img",{src:"/appPelis/avatar3.png",alt:""}),a.jsx("input",{type:"text",placeholder:"Nombre del perfil",required:!0,onChange:s=>c(s.target.value)}),a.jsx("button",{className:"buttonPerfilesCrear",onClick:P,disabled:d,children:d?"Creando...":"Crear"}),a.jsx("button",{className:"buttonListo",onClick:()=>l(!1),children:"Listo"})]}):!h&&(r.length===0?a.jsxs("div",{className:"flex flex-col contenedorManage",children:[a.jsx("h2",{className:"tituloPerfiles",children:"Crear un perfil"}),a.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crea un perfil"})]}):a.jsxs("div",{className:"PerfilesExistentesContainer",children:[a.jsx("h2",{className:"tituloPerfiles",children:"Selecciona un perfil"}),a.jsx("div",{className:"perfiles",children:r.map(s=>a.jsxs("div",{className:"contenedorPerfil",children:[a.jsx("img",{className:"perfil-img",src:"/appPelis/avatar3.png",alt:"",onClick:()=>C(s)}),a.jsx("h4",{className:"nombrePerfil",children:s.name}),a.jsx("i",{className:"fa-solid fa-x iconoX",onClick:t=>g(s.id,t)})]},s.id))}),a.jsx("button",{className:"buttonPerfiles",onClick:()=>l(!0),children:"Crear perfil"})]}))})}export{M as default};
